// @ts-nocheck
const jwt=require("jsonwebtoken"),verifyToken=(e,r,t)=>{try{const o=e.headers.authorization,s=o&&o.split(" ")[1];if(!s)return r.status(401).json({error:"Token missing"});const n=jwt.verify(s,process.env.JWT_SECRET);e.user=n,t()}catch(e){return r.status(403).json({error:"Invalid token"})}};module.exports=verifyToken;