// @ts-nocheck
const jwt=require("jsonwebtoken");require("dotenv").config();const verifyToken=(e,s,n)=>{const r=e.cookies?.accessToken;if(!r)return s.status(401).json({return_status:0,return_message:"Access token missing",return_data:null});jwt.verify(r,process.env.JWT_SECRET,((r,t)=>{if(r)return s.status(403).json({return_status:0,return_message:"Invalid or expired token",return_data:null});e.user=t,n()}))},generateAccessToken=e=>jwt.sign(e,process.env.JWT_SECRET,{expiresIn:process.env.ACCESS_TOKEN_EXPIRES}),generateRefreshToken=e=>jwt.sign(e,process.env.JWT_REFRESH_SECRET,{expiresIn:process.env.REFRESH_TOKEN_EXPIRES});module.exports={verifyToken:verifyToken,generateAccessToken:generateAccessToken,generateRefreshToken:generateRefreshToken};