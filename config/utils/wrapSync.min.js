// @ts-nocheck
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=asyncify;var _initialParams=require("./internal/initialParams.js"),_initialParams2=_interopRequireDefault(_initialParams),_setImmediate=require("./internal/setImmediate.js"),_setImmediate2=_interopRequireDefault(_setImmediate),_wrapAsync=require("./internal/wrapAsync.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncify(e){return(0,_wrapAsync.isAsync)(e)?function(...t){const r=t.pop();return handlePromise(e.apply(this,t),r)}:(0,_initialParams2.default)((function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}if(n&&"function"==typeof n.then)return handlePromise(n,r);r(null,n)}))}function handlePromise(e,t){return e.then((e=>{invokeCallback(t,null,e)}),(e=>{invokeCallback(t,e&&(e instanceof Error||e.message)?e:new Error(e))}))}function invokeCallback(e,t,r){try{e(t,r)}catch(e){(0,_setImmediate2.default)((e=>{throw e}),e)}}module.exports=exports.default;